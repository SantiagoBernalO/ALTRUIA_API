µË
ÇC:\Users\asant\OneDrive\Escritorio\Andres Bernal\proyectos\proyectoTEAServicios\proyectoTEAServicios\LogicaDeNegocio\LActividad.cs
	namespace 	
LogicaDeNegocio
 
{ 
public 

class 

LActividad 
{		 
public

 
List

	 
<

 
Utest

 
>

 
listaEnteros

 !
(

! "
)

" #
{ 
return 	
new
 
Datos 
. 
	Actividad 
( 
) 
.  
enteros  '
(' (
)( )
;) *
} 	
public 
List 
< 

UActividad 
> 
listaActividades  0
(0 1
int1 4
rol5 8
,8 9
string9 ?
id_card@ G
)G H
{ 	

UActividad 
	idDocente 
= 
new 

UActividad (
(( )
)) *
;* +
switch 	
(
 
rol 
) 
{ 
case 
$num	 

:
 
	idDocente 
. 
Docente_creador 
=  
id_card! (
;( )
break 

;
 
case 
$num	 

:
 
	UPaciente 
pacientInformation !
=" #
new$ '
UserPaciente( 4
(4 5
)5 6
.6 7!
getPatientInformation7 L
(L M
id_cardM T
)T U
;U V
	idDocente 
. 
Docente_creador 
=  
pacientInformation! 3
.3 4
Documento_docente4 E
;E F
break 

;
 
case 
$num	 

:
 
	idDocente 
. 
Docente_creador 
=  
id_card! (
;( )
return 
new 
Datos 
. 
	Actividad 
(  
)  !
.! "#
listaActividadesDocente" 9
(9 :
	idDocente: C
)C D
.D E
FindAllE L
(L M
xM N
=>O Q
xR S
.S T
	Estado_idT ]
==^ `
$numa b
)b c
;c d
} 
return 
new 
Datos 
. 
	Actividad &
(& '
)' (
.( )#
listaActividadesDocente) @
(@ A
	idDocenteA J
)J K
;K L
} 	
public   

UActividad  	 
getActivityId   !
(  ! "
int  " %
id_activity  & 1
)  1 2
{!! 
return"" 	
new""
 
Datos"" 
."" 
	Actividad"" 
("" 
)"" 
.""  
getActivityId""  -
(""- .
id_activity"". 9
)""9 :
;"": ;
}## 
public%% 
Wraper%% 
agregarActividad%% &
(%%& '

UActividad%%' 1

actividadE%%2 <
)%%< =
{&& 	
Wraper'' 
wp'' 
='' 
new'' 
Wraper'' "
(''" #
)''# $
;''$ %
try(( 
{)) 
int** 
cantidadActividades** '
=**( )
new*** -
Datos**. 3
.**3 4
	Actividad**4 =
(**= >
)**> ?
.**? @8
,verificarCantidadMaximaActividadesPorDocente**@ l
(**l m

actividadE**m w
)**w x
;**x y
int++ 
cantidadMaxima++ "
=++# $
$num++% &
;++& '
if,, 
(,, 
cantidadActividades,, '
>=,,( *
cantidadMaxima,,+ 9
),,9 :
{-- 
wp.. 
... 
Mensaje.. 
=..  
$str..! A
+..B C
cantidadMaxima..D R
+..S T
$str..U b
;..b c
return// 
wp// 
;// 
}00 
else11 
{22 
wp33 
.33 
Mensaje33 
=33  
$str33! ?
;33? @

actividadE44 
.44 
	Estado_id44 
=44 
$num44 
;44 
new55 
Datos55 
.55 
	Actividad55 '
(55' (
)55( )
.55) *
agregarActividad55* :
(55: ;

actividadE55; E
)55E F
;55F G
return77 
wp77 
;77 
}88 
}99 
catch:: 
(:: 
	Exception:: 
e:: 
):: 
{;; 
wp<< 
.<< 
Mensaje<< 
=<< 
$str<< %
+<<& '
e<<( )
;<<) *
return== 
wp== 
;== 
}>> 
}?? 	
publicAA 
stringAA	 '
activarODesactivarActividadAA +
(AA+ ,
intAA, /
id_actividadAA0 <
)AA< =
{BB 
returnCC 	
newCC
 
DatosCC 
.CC 
	ActividadCC 
(CC 
)CC 
.CC  )
desactivivarOActivarActividadCC  =
(CC= >
id_actividadCC> J
)CCJ K
;CCK L
}DD 
publicFF 
ListFF	 
<FF 
UTipoActividadFF 
>FF 
getTypeActivityFF -
(FF- .
)FF. /
{GG 
returnHH 	
newHH
 
DatosHH 
.HH 
	ActividadHH 
(HH 
)HH 
.HH  
getTypeActivityHH  /
(HH/ 0
)HH0 1
;HH1 2
}II 
publicKK 
stringKK	 #
postActividadEstudianteKK '
(KK' (

UActividadKK( 2
actividadRealizadaKK3 E
)KKE F
{LL 
returnMM 	
newMM
 
DatosMM 
.MM 
	ActividadMM 
(MM 
)MM 
.MM  
postActividadMM  -
(MM- .
actividadRealizadaMM. @
)MM@ A
;MMA B
}NN 
publicPP 
ListPP	 
<PP 
	UPacientePP 
>PP /
#getAcivitysDidByPatientForAttendantPP <
(PP< =
intPP= @
id_activityPPA L
,PPL M
stringPPM S
id_card_attendantPPT e
)PPe f
{QQ 
	UPacienteRR 
pacientInformationRR 
=RR  !
newRR" %
UserPacienteRR& 2
(RR2 3
)RR3 4
.RR4 5!
getPatientInformationRR5 J
(RRJ K
id_card_attendantRRK \
)RR\ ]
;RR] ^
returnSS 	
newSS
 
	ActividadSS 
(SS 
)SS 
.SS /
#getAcivitysDidByPatientForAttendantSS =
(SS= >
id_activitySS> I
,SSI J
pacientInformationSSJ \
.SS\ ]
	DocumentoSS] f
)SSf g
;SSg h
}TT 
publicVV 
ListVV	 
<VV 
	UPacienteVV 
>VV -
!getAcivitysDidByPatientForTeacherVV :
(VV: ;
intVV; >
id_activityVV? J
,VVJ K
stringVVK Q
id_card_teacherVVR a
)VVa b
{WW 
returnXX 	
newXX
 
	ActividadXX 
(XX 
)XX 
.XX -
!getAcivitysDidByPatientForTeacherXX ;
(XX; <
id_activityXX< G
,XXG H
id_card_teacherXXI X
)XXX Y
;XXY Z
}YY 
public[[ 
List[[	 
<[[ 
	UPaciente[[ 
>[[  
getStudienEvaluation[[ -
([[- .
)[[. /
{\\ 
return]] 	
new]]
 
	Actividad]] 
(]] 
)]] 
.]] "
patienteMakeEvaluation]] 0
(]]0 1
)]]1 2
;]]2 3
}^^ 
public__ 
List__	 
<__ '
UResultadoEvaluacionInicial__ )
>__) *
getScoreEvaluation__+ =
(__= >
string__> D
id_card_patient__E T
)__T U
{`` 
returnaa 	
newaa
 
	Actividadaa 
(aa 
)aa 
.aa #
patienteScoreEvaluationaa 1
(aa1 2
id_card_patientaa2 A
)aaA B
;aaB C
}bb 
publicdd 
Listdd	 
<dd 
UEvaluacionInicialdd  
>dd  !/
#getListActivitysToInicialEvaluationdd" E
(ddE F
intddF I
identificadorddJ W
)ddW X
{ee 	
Randomff 	
randomff
 
=ff 
newff 
Randomff 
(ff 
)ff 
;ff  
intgg 
[gg 
]gg 

activitiesgg	 
=gg 
newgg 
intgg 
[gg 
$numgg 
]gg  
;gg  !
inthh 
	randomnumhh 
;hh 
boolii 
existii 
;ii 
forjj 
(jj 
intjj 
ijj 
=jj 
$numjj 
;jj 
ijj 
<jj 
$numjj 
;jj 
ijj 
++jj 
)jj 
{kk 
	randomnumll 
=ll 
randomll 
.ll 
Nextll 
(ll 
$numll 
,ll 
$numll !
)ll! "
;ll" #
existmm 	
=mm
 
Arraymm 
.mm 
Existsmm 
(mm 

activitiesmm #
,mm# $
xmm% &
=>mm' )
xmm* +
==mm, .
	randomnummm/ 8
)mm8 9
;mm9 :
whilenn 
(nn 
existnn 
)nn 
{oo 
	randomnumpp 
=pp 
randompp 
.pp 
Nextpp 
(pp 
	randomnumpp &
+pp' (
$numpp) *
,pp* +
$numpp, .
)pp. /
;pp/ 0
existqq 

=qq 
Arrayqq 
.qq 
Existsqq 
(qq 

activitiesqq $
,qq$ %
xqq& '
=>qq( *
xqq+ ,
==qq- /
	randomnumqq0 9
)qq9 :
;qq: ;
}rr 
ifss 
(ss 
existss 
==ss 
falsess 
)ss 
{tt 

activitiesuu 
[uu 
iuu 
]uu 
=uu 
	randomnumuu 
;uu 
}vv 
}ww 
returnxx 	
newxx
 
	Actividadxx 
(xx 
)xx 
.xx /
#getListActivitysToInicialEvaluationxx =
(xx= >

activitiesxx> H
,xxH I
identificadorxxJ W
)xxW X
;xxX Y
}yy 	
publiczz 
Listzz	 
<zz 
PacienteScoreJSonzz 
>zz  
getResultActivityzz! 2
(zz2 3
intzz3 6
id_activityzz7 B
,zzB C
stringzzD J
id_card_patientzzK Z
)zzZ [
{{{ 
return|| 	
new||
 
Datos|| 
.|| 
	Actividad|| 
(|| 
)|| 
.||  !
GetPacienteScoreJSons||  5
(||5 6
id_activity||6 A
,||A B
id_card_patient||C R
)||R S
;||S T
}}} 
public
ÄÄ 
float
ÄÄ	 '
getScoreActivityImitation
ÄÄ (
(
ÄÄ( )
string
ÄÄ) /
phrases_base
ÄÄ0 <
,
ÄÄ< =
string
ÄÄ> D
phrases_said
ÄÄE Q
)
ÄÄQ R
{
ÅÅ 
phrases_base
ÇÇ 
=
ÇÇ 
phrases_base
ÇÇ 
.
ÇÇ 
ToLower
ÇÇ &
(
ÇÇ& '
)
ÇÇ' (
;
ÇÇ( )
phrases_said
ÉÉ 
=
ÉÉ 
phrases_said
ÉÉ 
.
ÉÉ 
ToLower
ÉÉ &
(
ÉÉ& '
)
ÉÉ' (
;
ÉÉ( )
string
ÑÑ 	(
phrases_base_without_spaci
ÑÑ
 $
=
ÑÑ% &1
#quitarEspaciosYCaracteresEspeciales
ÑÑ' J
(
ÑÑJ K
phrases_base
ÑÑK W
)
ÑÑW X
;
ÑÑX Y
string
ÖÖ 	(
phrases_said_without_spaci
ÖÖ
 $
=
ÖÖ% &1
#quitarEspaciosYCaracteresEspeciales
ÖÖ' J
(
ÖÖJ K
phrases_said
ÖÖK W
)
ÖÖW X
;
ÖÖX Y
int
ÜÜ 
cantidadMinima
ÜÜ 
=
ÜÜ (
phrases_base_without_spaci
ÜÜ 2
.
ÜÜ2 3
Length
ÜÜ3 9
<=
ÜÜ: <(
phrases_said_without_spaci
ÜÜ= W
.
ÜÜW X
Length
ÜÜX ^
?
ÜÜ_ `(
phrases_base_without_spaci
ÜÜa {
.
ÜÜ{ |
LengthÜÜ| Ç
:ÜÜÉ Ñ*
phrases_said_without_spaciÜÜÖ ü
.ÜÜü †
LengthÜÜ† ¶
;ÜÜ¶ ß
float
àà 
filtroCantidad
àà	 
=
àà &
filtroCantidadDePalabras
àà 2
(
àà2 3
phrases_base
àà3 ?
,
àà? @
phrases_said
ààA M
)
ààM N
;
ààN O
float
ââ  
filtroVecinosCerca
ââ	 
=
ââ 
kneiborNear
ââ )
(
ââ) *
phrases_base
ââ* 6
,
ââ6 7
phrases_said
ââ8 D
)
ââD E
;
ââE F
float
ää 
filtroPosicion
ää	 
=
ää &
porcentrajeDeAcertividad
ää 2
(
ää2 3(
phrases_said_without_spaci
ää3 M
,
ääM N(
phrases_base_without_spaci
ääO i
,
ääi j
cantidadMinima
ääk y
)
ääy z
;
ääz {
float
ãã 

scoreTotal
ãã	 
=
ãã 
(
ãã 
filtroCantidad
ãã %
+
ãã& ' 
filtroVecinosCerca
ãã( :
+
ãã; <
filtroPosicion
ãã= K
)
ããK L
/
ããM N
$num
ããO P
;
ããP Q
return
éé 	

scoreTotal
éé
 
*
éé 
$num
éé 
;
éé 
}
êê 
private
íí 	
float
íí
 &
filtroCantidadDePalabras
íí (
(
íí( )
string
íí) /
phrases_base
íí0 <
,
íí< =
string
íí> D
phrases_said
ííE Q
)
ííQ R
{
ìì 
float
îî !
phrases_base_length
îî	 
=
îî 
float
îî $
.
îî$ %
Parse
îî% *
(
îî* +
phrases_base
îî+ 7
.
îî7 8
Length
îî8 >
.
îî> ?
ToString
îî? G
(
îîG H
)
îîH I
)
îîI J
;
îîJ K
float
ïï !
phrases_said_length
ïï	 
=
ïï 
float
ïï $
.
ïï$ %
Parse
ïï% *
(
ïï* +
phrases_said
ïï+ 7
.
ïï7 8
Length
ïï8 >
.
ïï> ?
ToString
ïï? G
(
ïïG H
)
ïïH I
)
ïïI J
;
ïïJ K
if
óó 
(
óó 
phrases_base
óó 
.
óó 
Length
óó 
<
óó 
phrases_said
óó '
.
óó' (
Length
óó( .
)
óó. /
{
òò 
return
ôô 
!
phrases_base_length
ôô 
/
ôô  !
phrases_said_length
ôô! 4
;
ôô4 5
}
öö 
else
öö 
if
öö	 
(
öö 
phrases_base
öö 
.
öö 
Length
öö  
>
öö! "
phrases_said
öö# /
.
öö/ 0
Length
öö0 6
)
öö6 7
{
õõ 
return
úú 
!
phrases_said_length
úú 
/
úú  !
phrases_base_length
úú! 4
;
úú4 5
}
ùù 
else
ùù 
{
ûû 
return
üü 
!
phrases_base_length
üü 
/
üü  !
phrases_said_length
üü! 4
;
üü4 5
}
†† 
}
°° 
private
§§ 	
float
§§
 
kneiborNear
§§ 
(
§§ 
string
§§ "
phrases_base
§§# /
,
§§/ 0
string
§§1 7
phrases_said
§§8 D
)
§§D E
{
•• 
List
¶¶ 
<
¶¶ 
string
¶¶ 
>
¶¶ 
phrases_base_list
¶¶ !
=
¶¶" #
new
¶¶$ '
List
¶¶( ,
<
¶¶, -
string
¶¶- 3
>
¶¶3 4
(
¶¶4 5
)
¶¶5 6
;
¶¶6 7
List
ßß 
<
ßß 
string
ßß 
>
ßß 
phrases_said_list
ßß !
=
ßß" #
new
ßß$ '
List
ßß( ,
<
ßß, -
string
ßß- 3
>
ßß3 4
(
ßß4 5
)
ßß5 6
;
ßß6 7
float
®® $
cantDeVecinosAcertados
®®	 
=
®®  !
$num
®®" #
;
®®# $
phrases_base_list
´´ 
=
´´ !
fillListWithKneibor
´´ *
(
´´* +
phrases_base
´´+ 7
)
´´7 8
;
´´8 9
phrases_said_list
¨¨ 
=
¨¨ !
fillListWithKneibor
¨¨ *
(
¨¨* +
phrases_said
¨¨+ 7
)
¨¨7 8
;
¨¨8 9
foreach
ÆÆ 

(
ÆÆ
 
string
ÆÆ 
vecino
ÆÆ 
in
ÆÆ 
phrases_said_list
ÆÆ -
)
ÆÆ- .
{
ØØ 
if
∞∞ 
(
∞∞ 
phrases_base_list
∞∞ 
.
∞∞ 
Contains
∞∞ "
(
∞∞" #
vecino
∞∞# )
)
∞∞) *
)
∞∞* +
{
±± $
cantDeVecinosAcertados
≤≤ 
++
≤≤ 
;
≤≤ 
}
≥≥ 
}
¥¥ 
return
∂∂ 	$
cantDeVecinosAcertados
∂∂
  
/
∂∂! "
phrases_base
∂∂# /
.
∂∂/ 0
Length
∂∂0 6
;
∂∂6 7
}
∏∏ 
private
∫∫ 	
List
∫∫
 
<
∫∫ 
string
∫∫ 
>
∫∫ !
fillListWithKneibor
∫∫ *
(
∫∫* +
string
∫∫+ 1
phrase
∫∫2 8
)
∫∫8 9
{
ªª 
List
ΩΩ 
<
ΩΩ 
string
ΩΩ 
>
ΩΩ 
answear
ΩΩ 
=
ΩΩ 
new
ΩΩ 
List
ΩΩ "
<
ΩΩ" #
string
ΩΩ# )
>
ΩΩ) *
(
ΩΩ* +
)
ΩΩ+ ,
;
ΩΩ, -
string
øø 	
vecino
øø
 
=
øø 
(
øø 
(
øø 
phrase
øø 
.
øø 
ToCharArray
øø '
(
øø' (
)
øø( )
)
øø) *
[
øø* +
$num
øø+ ,
]
øø, -
)
øø- .
.
øø. /
ToString
øø/ 7
(
øø7 8
)
øø8 9
+
øø: ;
(
øø< =
(
øø= >
phrase
øø> D
.
øøD E
ToCharArray
øøE P
(
øøP Q
)
øøQ R
)
øøR S
[
øøS T
$num
øøT U
]
øøU V
)
øøV W
.
øøW X
ToString
øøX `
(
øø` a
)
øøa b
;
øøb c
answear
¿¿ 

.
¿¿
 
Add
¿¿ 
(
¿¿ 
vecino
¿¿ 
)
¿¿ 
;
¿¿ 
for
¬¬ 
(
¬¬ 
int
¬¬ 
i
¬¬ 
=
¬¬ 
$num
¬¬ 
;
¬¬ 
i
¬¬ 
<
¬¬ 
phrase
¬¬ 
.
¬¬ 
Length
¬¬ $
-
¬¬% &
$num
¬¬' (
;
¬¬( )
i
¬¬* +
++
¬¬+ -
)
¬¬- .
{
√√ 
vecino
ƒƒ 

=
ƒƒ 
(
ƒƒ 
(
ƒƒ 
phrase
ƒƒ 
.
ƒƒ 
ToCharArray
ƒƒ !
(
ƒƒ! "
)
ƒƒ" #
)
ƒƒ# $
[
ƒƒ$ %
i
ƒƒ% &
-
ƒƒ' (
$num
ƒƒ) *
]
ƒƒ* +
)
ƒƒ+ ,
.
ƒƒ, -
ToString
ƒƒ- 5
(
ƒƒ5 6
)
ƒƒ6 7
+
ƒƒ8 9
(
ƒƒ: ;
(
ƒƒ; <
phrase
ƒƒ< B
.
ƒƒB C
ToCharArray
ƒƒC N
(
ƒƒN O
)
ƒƒO P
)
ƒƒP Q
[
ƒƒQ R
i
ƒƒR S
]
ƒƒS T
)
ƒƒT U
.
ƒƒU V
ToString
ƒƒV ^
(
ƒƒ^ _
)
ƒƒ_ `
+
ƒƒa b
(
ƒƒc d
(
ƒƒd e
phrase
ƒƒe k
.
ƒƒk l
ToCharArray
ƒƒl w
(
ƒƒw x
)
ƒƒx y
)
ƒƒy z
[
ƒƒz {
i
ƒƒ{ |
+
ƒƒ} ~
$numƒƒ Ä
]ƒƒÄ Å
)ƒƒÅ Ç
.ƒƒÇ É
ToStringƒƒÉ ã
(ƒƒã å
)ƒƒå ç
;ƒƒç é
answear
≈≈ 
.
≈≈ 
Add
≈≈ 
(
≈≈ 
vecino
≈≈ 
)
≈≈ 
;
≈≈ 
}
∆∆ 
vecino
«« 	
=
««
 
(
«« 
(
«« 
phrase
«« 
.
«« 
ToCharArray
««  
(
««  !
)
««! "
)
««" #
[
««# $
phrase
««$ *
.
««* +
Length
««+ 1
-
««2 3
$num
««4 5
]
««5 6
)
««6 7
.
««7 8
ToString
««8 @
(
««@ A
)
««A B
+
««C D
(
««E F
(
««F G
phrase
««G M
.
««M N
ToCharArray
««N Y
(
««Y Z
)
««Z [
)
««[ \
[
««\ ]
phrase
««] c
.
««c d
Length
««d j
-
««j k
$num
««k l
]
««l m
)
««m n
.
««n o
ToString
««o w
(
««w x
)
««x y
;
««y z
answear
»» 

.
»»
 
Add
»» 
(
»» 
vecino
»» 
)
»» 
;
»» 
return
   	
answear
  
 
;
   
}
ÃÃ 
private
œœ 	
string
œœ
 1
#quitarEspaciosYCaracteresEspeciales
œœ 4
(
œœ4 5
string
œœ5 ;
palabraAModificar
œœ< M
)
œœM N
{
œœN O
return
–– 	
palabraAModificar
––
 
.
–– 
Replace
–– #
(
––# $
$str
––$ R
,
––R S
$str
––T V
)
––V W
.
––W X
Replace
––X _
(
––_ `
$str
––` c
,
––c d
$str
––e g
)
––g h
;
––h i
}
—— 
private
‘‘ 	
int
‘‘
 &
porcentrajeDeAcertividad
‘‘ &
(
‘‘& '
string
‘‘' -

fraseDicha
‘‘. 8
,
‘‘8 9
string
‘‘9 ?
fraseAdecir
‘‘@ K
,
‘‘K L
int
‘‘M P&
cantidadMinimaDePalabras
‘‘Q i
)
‘‘i j
{
‘‘j k
var
’’ %
cant_acertada_de_letras
’’ 
=
’’  
$num
’’! "
;
’’" #
var
÷÷ 

porcentaje
÷÷ 
=
÷÷ 
$num
÷÷ 
;
÷÷ 
for
◊◊ 
(
◊◊ 
var
◊◊ 

i
◊◊ 
=
◊◊ 
$num
◊◊ 
;
◊◊ 
i
◊◊ 
<
◊◊ 
fraseAdecir
◊◊ 
.
◊◊ 
Length
◊◊ #
;
◊◊# $
i
◊◊$ %
++
◊◊% '
)
◊◊' (
{
◊◊( )
if
ÿÿ 
(
ÿÿ 
i
ÿÿ 	
<
ÿÿ	 
&
cantidadMinimaDePalabras
ÿÿ
 "
)
ÿÿ" #
{
ÿÿ# $
if
ŸŸ 
(
ŸŸ 	
(
ŸŸ	 

fraseAdecir
ŸŸ
 
.
ŸŸ 
ToCharArray
ŸŸ !
(
ŸŸ! "
)
ŸŸ" #
)
ŸŸ# $
[
ŸŸ$ %
i
ŸŸ% &
]
ŸŸ& '
==
ŸŸ( *
(
ŸŸ+ ,

fraseDicha
ŸŸ, 6
.
ŸŸ6 7
ToCharArray
ŸŸ7 B
(
ŸŸB C
)
ŸŸC D
)
ŸŸD E
[
ŸŸE F
i
ŸŸF G
]
ŸŸG H
)
ŸŸH I
{
ŸŸI J%
cant_acertada_de_letras
⁄⁄ 
++
⁄⁄ 
;
⁄⁄  
}
€€ 
}
‹‹ 
else
‹‹ 

{
‹‹
 
break
›› 

;
››
 
}
ﬁﬁ 
}
ﬂﬂ 

porcentaje
‡‡ 
=
‡‡ 
(
‡‡ %
cant_acertada_de_letras
‡‡ '
)
‡‡' (
/
‡‡( )
fraseAdecir
‡‡) 4
.
‡‡4 5
Length
‡‡5 ;
;
‡‡; <
return
·· 	

porcentaje
··
 
;
·· 
}
‚‚ 
public
ÂÂ 
string
ÂÂ	 
guardarResultados
ÂÂ !
(
ÂÂ! ")
UResultadoEvaluacionInicial
ÂÂ" =
[
ÂÂ= >
]
ÂÂ> ?

actividadE
ÂÂ@ J
)
ÂÂJ K
{
ÊÊ 
for
ÁÁ 
(
ÁÁ 
var
ÁÁ 
i
ÁÁ 
=
ÁÁ 
$num
ÁÁ 
;
ÁÁ 
i
ÁÁ 
<
ÁÁ 

actividadE
ÁÁ !
.
ÁÁ! "
Length
ÁÁ" (
;
ÁÁ( )
i
ÁÁ* +
++
ÁÁ+ -
)
ÁÁ- .
{
ËË 

actividadE
ÈÈ 
[
ÈÈ 
i
ÈÈ 
]
ÈÈ 
.
ÈÈ 
Fecha
ÈÈ 
=
ÈÈ 
DateTime
ÈÈ "
.
ÈÈ" #
Now
ÈÈ# &
.
ÈÈ& '
Date
ÈÈ' +
;
ÈÈ+ ,
new
ÍÍ 
Datos
ÍÍ 
.
ÍÍ 
	Actividad
ÍÍ 
(
ÍÍ 
)
ÍÍ 
.
ÍÍ "
putInsertarresultado
ÍÍ .
(
ÍÍ. /

actividadE
ÍÍ/ 9
[
ÍÍ9 :
i
ÍÍ: ;
]
ÍÍ; <
)
ÍÍ< =
;
ÍÍ= >
}
ÎÎ 
return
ÏÏ 	
$str
ÏÏ
 
;
ÏÏ 
}
ÌÌ 
public
 
List
	 
<
 &
UActividadPecsCategorias
 &
>
& '
categoriasPECS
( 6
(
6 7
string
7 =

id_docente
> H
,
H I
string
J P
id_estudiante
Q ^
)
^ _
{
ÒÒ 
return
ÚÚ 	
new
ÚÚ
 
Datos
ÚÚ 
.
ÚÚ 
	Actividad
ÚÚ 
(
ÚÚ 
)
ÚÚ 
.
ÚÚ  )
getListaCategoriasAsignadas
ÚÚ  ;
(
ÚÚ; <

id_docente
ÚÚ< F
,
ÚÚF G
id_estudiante
ÚÚH U
)
ÚÚU V
;
ÚÚV W
}
ÛÛ 
public
ˆˆ 
int
ˆˆ	 $
cantidadCategoriasPECS
ˆˆ #
(
ˆˆ# $
string
ˆˆ$ *

id_docente
ˆˆ+ 5
,
ˆˆ5 6
string
ˆˆ7 =
id_estudiante
ˆˆ> K
)
ˆˆK L
{
˜˜ 
return
¯¯ 	
new
¯¯
 
Datos
¯¯ 
.
¯¯ 
	Actividad
¯¯ 
(
¯¯ 
)
¯¯ 
.
¯¯  ,
getCantidadCategoriasAsignadas
¯¯  >
(
¯¯> ?

id_docente
¯¯? I
,
¯¯I J
id_estudiante
¯¯K X
)
¯¯X Y
;
¯¯Y Z
}
˘˘ 
public
˚˚ 
List
˚˚	 
<
˚˚ &
UActividadPecsCategorias
˚˚ &
>
˚˚& '
categoriasPECS
˚˚( 6
(
˚˚6 7
string
˚˚7 =

id_docente
˚˚> H
)
˚˚H I
{
¸¸ 
return
˝˝ 	
new
˝˝
 
Datos
˝˝ 
.
˝˝ 
	Actividad
˝˝ 
(
˝˝ 
)
˝˝ 
.
˝˝   
getListaCategorias
˝˝  2
(
˝˝2 3

id_docente
˝˝3 =
)
˝˝= >
;
˝˝> ?
}
˛˛ 
public
ÅÅ 
List
ÅÅ	 
<
ÅÅ 
UActividadPecs
ÅÅ 
>
ÅÅ 
imagenesPECS
ÅÅ *
(
ÅÅ* +
string
ÅÅ+ 1

id_docente
ÅÅ2 <
,
ÅÅ< =
string
ÅÅ> D
id_estudiante
ÅÅE R
,
ÅÅR S
int
ÅÅT W
categoria_id
ÅÅX d
)
ÅÅd e
{
ÇÇ 
return
ÉÉ 	
new
ÉÉ
 
Datos
ÉÉ 
.
ÉÉ 
	Actividad
ÉÉ 
(
ÉÉ 
)
ÉÉ 
.
ÉÉ  '
getListaImagenesAsignadas
ÉÉ  9
(
ÉÉ9 :

id_docente
ÉÉ: D
,
ÉÉD E
id_estudiante
ÉÉF S
,
ÉÉS T
categoria_id
ÉÉU a
)
ÉÉa b
;
ÉÉb c
}
ÑÑ 
public
ÜÜ 
string
ÜÜ	 )
activar_DesactivarCategoria
ÜÜ +
(
ÜÜ+ ,
int
ÜÜ, /
id_actividad
ÜÜ0 <
)
ÜÜ< =
{
áá 
return
àà 	
new
àà
 
Datos
àà 
.
àà 
	Actividad
àà 
(
àà 
)
àà 
.
àà  +
desactivivar_ActivarCategoria
àà  =
(
àà= >
id_actividad
àà> J
)
ààJ K
;
ààK L
}
ââ 
public
åå 
string
åå	 
guardarCategoria
åå  
(
åå  !&
UActividadPecsCategorias
åå! 9

categoriaE
åå: D
)
ååD E
{
çç 
new
èè 
Datos
èè 
.
èè 
	Actividad
èè 
(
èè 
)
èè 
.
èè "
putInsertarcategoria
èè -
(
èè- .

categoriaE
èè. 8
)
èè8 9
;
èè9 :
return
ëë 	
$str
ëë
 
;
ëë 
}
íí 
public
ïï 
string
ïï	 (
guardarActividadPECSImagen
ïï *
(
ïï* +
UActividadPecs
ïï+ 9

actividadE
ïï: D
)
ïïD E
{
ññ 
new
òò 
Datos
òò 
.
òò 
	Actividad
òò 
(
òò 
)
òò 
.
òò ,
putInsertaractividadImagenPECS
òò 7
(
òò7 8

actividadE
òò8 B
)
òòB C
;
òòC D
return
öö 	
$str
öö
 
;
öö 
}
õõ 
}
ùù 
}ûû £l
ÖC:\Users\asant\OneDrive\Escritorio\Andres Bernal\proyectos\proyectoTEAServicios\proyectoTEAServicios\LogicaDeNegocio\LIngresoLogin.cs
	namespace 	
LogicaDeNegocio
 
{ 
public 

class 
LIngresoLogin 
{ 
public 
async 
Task 
< 
Wraper  
>  !
ingresoLogin" .
(. /
UUsers/ 5
usuarioE6 >
)> ?
{ 	
Wraper 
wraper 
= 
new 
Wraper  &
(& '
)' (
;( )
try 
{ 
if 
( 
new 
Datos !
.! "

UsersLogin" ,
(, -
)- .
.. /&
verificarExistenciaUsuario/ I
(I J
usuarioEJ R
)R S
==T V
nullW [
)[ \
{ 
wraper 
. 
Mensaje &
=' (
$str) i
;i j
wraper 
. 
WraperUsuario ,
=- .
null/ 3
;3 4
return 
wraper %
;% &
} 
else 
{ 
if 
( 
new 
Datos  %
.% &

UsersLogin& 0
(0 1
)1 2
.2 3
verificarLogin3 A
(A B
usuarioEB J
)J K
==L N
nullO S
)S T
{ 
wraper   "
.  " #
Mensaje  # *
=  + ,
$str  - Y
;  Y Z
wraper!! "
.!!" #
WraperUsuario!!# 0
=!!1 2
null!!3 7
;!!7 8
return"" "
wraper""# )
;"") *
}## 
else$$ 
{%% 
UAcceso&& #
acceso&&$ *
=&&+ ,
new&&- 0
UAcceso&&1 8
(&&8 9
)&&9 :
;&&: ;
wraper'' "
.''" #
Mensaje''# *
=''+ ,
$str''- U
;''U V
wraper(( "
.((" #
WraperUsuario((# 0
=((1 2
new((3 6
Datos((7 <
.((< =

UsersLogin((= G
(((G H
)((H I
.((I J&
datosUsuarioSegunDocumento((J d
(((d e
usuarioE((e m
)((m n
;((n o
acceso)) "
.))" #
Fecha_inicioSesion))# 5
=))6 7
DateTime))8 @
.))@ A
Now))A D
;))D E
acceso** "
.**" #
Sesion**# )
=*** +
usuarioE**, 4
.**4 5
Sesion**5 ;
;**; <
acceso++ "
.++" #
Fecha_finSesion++# 2
=++3 4
null++5 9
;++9 :
acceso,, "
.,," #

Id_usuario,,# -
=,,. /
wraper,,0 6
.,,6 7
WraperUsuario,,7 D
.,,D E
Id,,E G
;,,G H
new-- 
Datos--  %
.--% &

UsersLogin--& 0
(--0 1
)--1 2
.--2 3
agregarAcceso--3 @
(--@ A
acceso--A G
)--G H
;--H I
return.. 
wraper.. %
;..% &
}// 
}00 
}22 
catch33 
(33 
	Exception33 
e33 
)33 
{44 
wraper55 
.55 
Mensaje55 
=55  
$str55! *
+55+ ,
e55- .
;55. /
return66 
wraper66 
;66 
}77 
}88 	
public:: 
async:: 
Task:: 
guardarToken:: &
(::& '

LoginToken::' 1
token::2 7
)::7 8
{;; 	
await<< 
new<< 
	Seguridad<< 
(<<  
)<<  !
.<<! "
guardarTokenLogin<<" 3
(<<3 4
token<<4 9
)<<9 :
;<<: ;
}== 	
public@@ 
string@@ 
cerrarsession@@ #
(@@# $
UUsers@@$ *
session@@+ 2
)@@2 3
{AA 	
tryBB 
{CC 
UUsersDD 
datosDD 
=DD 
newDD "

UsersLoginDD# -
(DD- .
)DD. /
.DD/ 0&
datosUsuarioSegunDocumentoDD0 J
(DDJ K
sessionDDK R
)DDR S
;DDS T
newEE 
	SeguridadEE 
(EE 
)EE 
.EE  
cerrarAccesoEE  ,
(EE, -
datosEE- 2
.EE2 3
IdEE3 5
)EE5 6
;EE6 7
newFF 
	SeguridadFF 
(FF 
)FF 
.FF  
borrarTokenLoginFF  0
(FF0 1
datosFF1 6
)FF6 7
;FF7 8
stringHH 
urlHH 
=HH 
$strHH ,
;HH, -
returnII 
urlII 
;II 
}JJ 
catchKK 
(KK 
	ExceptionKK 
exKK 
)KK 
{LL 
stringMM 
errorMjsMM 
=MM  !
$strMM" 7
+MM8 9
exMM: <
;MM< =
returnNN 
errorMjsNN 
;NN  
}OO 
}QQ 	
publicRR 
stringRR	  
accesoTokenRecuperarRR $
(RR$ %
stringRR% +
tokenRR, 1
)RR1 2
{SS 
tryTT 
{UU 
UUsersVV 

usuarioTokenVV 
=VV 
newVV 

UsersLoginVV (
(VV( )
)VV) *
.VV* + 
accesoRecuperarClaveVV+ ?
(VV? @
tokenVV@ E
)VVE F
;VVF G
ifWW 
(WW 
usuarioTokenWW 
==WW 
nullWW 
)WW 
{XX 
returnYY 
$strYY 4
;YY4 5
}ZZ 
ifZZ 
(ZZ 	
usuarioTokenZZ	 
.ZZ 
Token_expirarZZ #
<ZZ$ %
DateTimeZZ& .
.ZZ. /
NowZZ/ 2
)ZZ2 3
{[[ 
return\\ 
$str\\ 5
;\\5 6
}]] 
return^^ 

$str^^ 
;^^ 
}__ 
catch`` 
(``	 

	Exception``
 
ex`` 
)`` 
{aa 
stringbb 

errorMjsbb 
=bb 
$strbb +
+bb, -
exbb. 0
;bb0 1
returncc 

errorMjscc 
;cc 
}dd 
}ee 
publicff 
stringff	 

nuevaClaveff 
(ff 
UUsersff !
nuevaClaveUserff" 0
)ff0 1
{gg 
tryhh 
{ii 
UUsersjj 

cambiarClavejj 
=jj 
newjj 

UsersLoginjj (
(jj( )
)jj) *
.jj* + 
accesoRecuperarClavejj+ ?
(jj? @
nuevaClaveUserjj@ N
.jjN O
TokenjjO T
)jjT U
;jjU V
ifkk 
(kk 
cambiarClavekk 
==kk 
nullkk 
||kk 
cambiarClavekk  ,
.kk, -
Token_expirarkk- :
<kk; <
DateTimekk= E
.kkE F
NowkkF I
)kkI J
{ll 
returnmm 
$strmm 4
;mm4 5
}nn 
elseoo 
{pp 
cambiarClaveqq 
.qq 
Claveqq 
=qq 
nuevaClaveUserqq (
.qq( )
Claveqq) .
;qq. /
cambiarClaverr 
.rr 
Tokenrr 
=rr 
nullrr 
;rr 
cambiarClavess 
.ss 
Token_expirarss 
=ss  !
nullss" &
;ss& '
newtt 

UsersLogintt	 
(tt 
)tt 
.tt %
cambiarDatosParaRecuperartt /
(tt/ 0
cambiarClavett0 <
)tt< =
;tt= >
returnuu 
$struu (
;uu( )
}vv 
}ww 
catchxx 
(xx 	
	Exceptionxx	 
exxx 
)xx 
{yy 
stringzz 

errorMjszz 
=zz 
$strzz +
+zz, -
exzz. 0
;zz0 1
return{{ 

errorMjs{{ 
;{{ 
}|| 
}~~ 
public 
string	 &
enviarCorreoDeRecuperacion *
(* +
string+ 1
correo2 8
)8 9
{
ÄÄ 
try
ÅÅ 
{
ÇÇ 
UUsers
ÉÉ 

correoUsuario
ÉÉ 
=
ÉÉ 
new
ÉÉ 

UsersLogin
ÉÉ )
(
ÉÉ) *
)
ÉÉ* +
.
ÉÉ+ ,
confirmarCorreo
ÉÉ, ;
(
ÉÉ; <
correo
ÉÉ< B
)
ÉÉB C
;
ÉÉC D
if
ÑÑ 
(
ÑÑ 
correoUsuario
ÑÑ 
!=
ÑÑ 
null
ÑÑ 
)
ÑÑ 
{
ÖÖ 
correoUsuario
ÜÜ 
.
ÜÜ 
Clave
ÜÜ 
=
ÜÜ 
$str
ÜÜ 
;
ÜÜ 
correoUsuario
áá 
.
áá 
Token_expirar
áá  
=
áá! "
DateTime
áá# +
.
áá+ ,
Now
áá, /
.
áá/ 0
AddDays
áá0 7
(
áá7 8
$num
áá8 9
)
áá9 :
;
áá: ;
correoUsuario
àà 
.
àà 
Token
àà 
=
àà 
	encriptar
àà $
(
àà$ %
JsonConvert
àà% 0
.
àà0 1
SerializeObject
àà1 @
(
àà@ A
correoUsuario
ààA N
)
ààN O
)
ààO P
;
ààP Q
if
ââ 
(
ââ 	
correoUsuario
ââ	 
.
ââ 
Rol_id
ââ 
==
ââ  
$num
ââ! "
)
ââ" #
{
ää 
UDocente
ãã 
docente
ãã 
=
ãã 
new
ãã 
UDocente
ãã %
(
ãã% &
)
ãã& '
;
ãã' (
docente
åå 
.
åå 
Correo
åå 
=
åå 
correo
åå 
;
åå 
new
çç 	
Mail
çç
 
(
çç 
)
çç 
.
çç 

enviarMail
çç 
(
çç 
docente
çç #
,
çç# $
correoUsuario
çç% 2
.
çç2 3
Token
çç3 8
)
çç8 9
;
çç9 :
}
éé 
else
èè 	
if
èè
 
(
èè 
correoUsuario
èè 
.
èè 
Rol_id
èè "
==
èè# %
$num
èè& '
)
èè' (
{
êê 

UAcudiente
ëë 
	acudiente
ëë 
=
ëë 
new
ëë  

UAcudiente
ëë! +
(
ëë+ ,
)
ëë, -
;
ëë- .
	acudiente
íí 
.
íí 
Correo
íí 
=
íí 
correo
íí 
;
íí  
new
ìì 	
Mail
ìì
 
(
ìì 
)
ìì 
.
ìì 

enviarMail
ìì 
(
ìì 
	acudiente
ìì %
,
ìì% &
correoUsuario
ìì' 4
.
ìì4 5
Token
ìì5 :
)
ìì: ;
;
ìì; <
}
îî 
new
ïï 

UsersLogin
ïï	 
(
ïï 
)
ïï 
.
ïï '
cambiarDatosParaRecuperar
ïï /
(
ïï/ 0
correoUsuario
ïï0 =
)
ïï= >
;
ïï> ?
return
ññ 
$str
ññ 4
;
ññ4 5
}
óó 
return
òò 

$str
òò  
;
òò  !
}
ôô 
catch
öö 
(
öö	 

	Exception
öö
 
ex
öö 
)
öö 
{
õõ 
string
úú 

errorMjs
úú 
=
úú 
$str
úú +
+
úú, -
ex
úú. 0
;
úú0 1
return
ùù 

errorMjs
ùù 
;
ùù 
}
ûû 
}
†† 
private
°° 	
string
°°
 
	encriptar
°° 
(
°° 
string
°° !
entrada
°°" )
)
°°) *
{
¢¢ )
SHA256CryptoServiceProvider
££ 
prueba
££ %
=
££& '
new
££( +)
SHA256CryptoServiceProvider
££, G
(
££G H
)
££H I
;
££I J
byte
•• 
[
•• 
]
•• 	
entradaByte
••
 
=
•• 
Encoding
••  
.
••  !
UTF8
••! %
.
••% &
GetBytes
••& .
(
••. /
entrada
••/ 6
)
••6 7
;
••7 8
byte
¶¶ 
[
¶¶ 
]
¶¶ 	
hashedBytes
¶¶
 
=
¶¶ 
prueba
¶¶ 
.
¶¶ 
ComputeHash
¶¶ *
(
¶¶* +
entradaByte
¶¶+ 6
)
¶¶6 7
;
¶¶7 8
StringBuilder
®® 
salida
®® 
=
®® 
new
®® 
StringBuilder
®® +
(
®®+ ,
)
®®, -
;
®®- .
for
™™ 
(
™™ 
int
™™ 
i
™™ 
=
™™ 
$num
™™ 
;
™™ 
i
™™ 
<
™™ 
hashedBytes
™™ "
.
™™" #
Length
™™# )
;
™™) *
i
™™+ ,
++
™™, .
)
™™. /
{
´´ 
salida
¨¨ 

.
¨¨
 
Append
¨¨ 
(
¨¨ 
hashedBytes
¨¨ 
[
¨¨ 
i
¨¨ 
]
¨¨  
.
¨¨  !
ToString
¨¨! )
(
¨¨) *
$str
¨¨* .
)
¨¨. /
.
¨¨/ 0
ToLower
¨¨0 7
(
¨¨7 8
)
¨¨8 9
)
¨¨9 :
;
¨¨: ;
}
≠≠ 
return
ÆÆ 	
salida
ÆÆ
 
.
ÆÆ 
ToString
ÆÆ 
(
ÆÆ 
)
ÆÆ 
;
ÆÆ 
}
ØØ 
}
∞∞ 
}±± à'
ÅC:\Users\asant\OneDrive\Escritorio\Andres Bernal\proyectos\proyectoTEAServicios\proyectoTEAServicios\LogicaDeNegocio\LPaciente.cs
	namespace 	
LogicaDeNegocio
 
{ 
public 
class 
	LPaciente 
{ 
public

 
String

	 "
enlazarDocentePaciente

 &
(

& '
UDocente

' /
docente

0 7
)

7 8
{ 
if 
( 
new 

Datos 
. 
UsersRegister 
( 
)  
.  !&
AcudienteODocenteExistente! ;
(; <
docente< C
.C D
	DocumentoD M
,M N
$numO P
)P Q
!=R T
nullU Y
&&Z \
new] `
Datosa f
.f g
UserPacienteg s
(s t
)t u
.u v.
!verificarExistenciaDocenteEnlazar	v ó
(
ó ò
docente
ò ü
)
ü †
.
† °
Documento_docente
° ≤
==
≥ µ
null
∂ ∫
) 
{ 
if 
( 
new 
Datos 
. 
UserPaciente 
( 
)  
.  !4
(verificarDocentePacienteMismaInstitucion! I
(I J
docenteJ Q
)Q R
)R S
{ 
new 
Datos	 
. 
UserPaciente 
( 
) 
. "
enlazarPacienteDocente 4
(4 5
docente5 <
)< =
;= >
return 
$str 
; 
} 
else 
{ 
return 
$str 2
;2 3
} 
} 
else 
{ 
return 

$str 3
;3 4
} 
} 
public   
List  	 
<   
	UPaciente   
>   (
obtenerEstudiantesPorEnlazar   5
(  5 6
int  6 9
id  : <
)  < =
{!! 
return"" 	
new""
 
Datos"" 
."" 
UserPaciente""  
(""  !
)""! "
.""" #&
obtenerPacientesPorEnlazar""# =
(""= >
id""> @
)""@ A
;""A B
}## 
public%% 
List%%	 
<%% 
	UPaciente%% 
>%% '
obtenerEstudiantesEnlazados%% 4
(%%4 5
int%%5 8
id%%9 ;
,%%; <
	UPaciente%%= F
tipoUsuario%%G R
)%%R S
{&& 
return'' 	
new''
 
Datos'' 
.'' 
UserPaciente''  
(''  !
)''! "
.''" #%
obtenerPacientesEnlazados''# <
(''< =
id''= ?
,''? @
tipoUsuario''A L
)''L M
;''M N
}(( 
public++ 
string++	  
enlazarConEstudiante++ $
(++$ %
	UPaciente++% .
datosAenlazar++/ <
)++< =
{,, 
if-- 
(-- 
datosAenlazar-- 
.-- 
Documento_docente-- &
!=--' )
null--* .
)--. /
{.. 
new// 
Datos// 
.// 
UserPaciente// 
(// 
)// 
.// '
enlazarDocenteConEstudiante// 8
(//8 9
datosAenlazar//9 F
)//F G
;//G H
}11 
else11 
if11	 
(11 
datosAenlazar11 
.11 
Documento_acudiente11 .
!=11/ 1
null112 6
)116 7
{22 
new33 
Datos33 
.33 
UserPaciente33 
(33 
)33 
.33 )
enlazarAcudienteConEstudiante33 :
(33: ;
datosAenlazar33; H
)33H I
;33I J
}44 
return55 	
$str55
 
;55  
}66 
public88 
string88	 
eliminarEnlace88 
(88 
	UPaciente88 (
datosAenlazar88) 6
)886 7
{99 
new:: 
Datos:: 
.:: 
UserPaciente:: 
(:: 
):: 
.:: 
eliminarEnlace:: *
(::* +
datosAenlazar::+ 8
)::8 9
;::9 :
return;; 	
$str;;
 *
;;;* +
}<< 
public== 
	UPaciente==	 
datosPaciente==  
(==  !
string==! '
documentoPaciente==( 9
)==9 :
{>> 
return?? 	
new??
 
Datos?? 
.?? 
UserPaciente??  
(??  !
)??! "
.??" #
datosPaciente??# 0
(??0 1
documentoPaciente??1 B
)??B C
;??C D
}@@ 
}BB 
}CC •π
áC:\Users\asant\OneDrive\Escritorio\Andres Bernal\proyectos\proyectoTEAServicios\proyectoTEAServicios\LogicaDeNegocio\LUserRegistercs.cs
	namespace 	
LogicaDeNegocio
 
{ 
public 
class 
LUserRegistercs 
{		 
public 
String	 #
agregarUsuarioAcudiente '
(' (

UAcudiente( 2
nuevoAcudiente3 A
)A B
{ 
try 
{ 
Wraper 

wraper 
= 
new 
Wraper 
( 
)  
;  !
UUsers 

nuevoUsuario 
= 
new 
UUsers $
($ %
)% &
;& '
nuevoUsuario 
. 
	Documento 
= 
nuevoAcudiente +
.+ ,
	Documento, 5
;5 6
nuevoUsuario 
. 
Clave 
= 
nuevoAcudiente '
.' (
Clave( -
;- .
nuevoUsuario 
. 
Rol_id 
= 
$num 
; 
if 
( 
( 	
new	 
Datos 
. 
UsersRegister  
(  !
)! "
." #4
(verificarExistenciaDeCedulaRespectoIdRol# K
(K L
nuevoUsuarioL X
)X Y
)Y Z
==[ ]
null^ b
&&c e
!f g
(g h
newh k
Datosl q
.q r
UsersRegisterr 
(	 Ä
)
Ä Å
.
Å Ç'
revisarExistenciaDeCorreo
Ç õ
(
õ ú
nuevoAcudiente
ú ™
.
™ ´
Correo
´ ±
)
± ≤
)
≤ ≥
)
≥ ¥
{ 
new 
Datos	 
. 
UsersRegister 
( 
) 
. 
agregarUsuario -
(- .
nuevoUsuario. :
): ;
;; <
new 
Datos	 
. 
UsersRegister 
( 
) 
. 
agregarAcudiente /
(/ 0
nuevoAcudiente0 >
)> ?
;? @
return 
wraper 
. 
Mensaje 
= 
$str 3
;3 4
} 
else 
{ 
return 
wraper 
. 
Mensaje 
= 
$str 5
;5 6
} 
}   
catch!! 
(!!	 

	Exception!!
 
e!! 
)!! 
{"" 
return## 

$str## 
+## 
e## 
;## 
}$$ 
}%% 
public'' 
String''	 !
agregarUsuarioDocente'' %
(''% &
UDocente''& .
nuevoDocente''/ ;
)''; <
{(( 
try)) 
{** 
Wraper++ 

wraper++ 
=++ 
new++ 
Wraper++ 
(++ 
)++  
;++  !
UUsers-- 

nuevoUsuario-- 
=-- 
new-- 
UUsers-- $
(--$ %
)--% &
;--& '
nuevoUsuario.. 
... 
	Documento.. 
=.. 
nuevoDocente.. )
...) *
	Documento..* 3
;..3 4
nuevoUsuario// 
.// 
Clave// 
=// 
nuevoDocente// %
.//% &
Clave//& +
;//+ ,
nuevoUsuario00 
.00 
Rol_id00 
=00 
$num00 
;00 
if22 
(22 
(22 	
new22	 
Datos22 
.22 
UsersRegister22  
(22  !
)22! "
.22" #4
(verificarExistenciaDeCedulaRespectoIdRol22# K
(22K L
nuevoUsuario22L X
)22X Y
)22Y Z
==22[ ]
null22^ b
&&22c e
!22f g
(22g h
new22h k
Datos22l q
.22q r
UsersRegister22r 
(	22 Ä
)
22Ä Å
.
22Å Ç'
revisarExistenciaDeCorreo
22Ç õ
(
22õ ú
nuevoDocente
22ú ®
.
22® ©
Correo
22© Ø
)
22Ø ∞
)
22∞ ±
)
22± ≤
{33 
new44 
Datos44	 
.44 
UsersRegister44 
(44 
)44 
.44 
agregarUsuario44 -
(44- .
nuevoUsuario44. :
)44: ;
;44; <
new55 
Datos55	 
.55 
UsersRegister55 
(55 
)55 
.55 
agregarDocente55 -
(55- .
nuevoDocente55. :
)55: ;
;55; <
return66 
wraper66 
.66 
Mensaje66 
=66 
$str66 3
;663 4
}77 
else88 
{99 
return:: 
wraper:: 
.:: 
Mensaje:: 
=:: 
$str:: 5
;::5 6
};; 
}<< 
catch== 
(==	 

	Exception==
 
e== 
)== 
{>> 
return?? 

$str?? 
+?? 
e?? 
;?? 
}@@ 
}AA 
publicBB 
StringBB	 "
agregarUsuarioPacienteBB &
(BB& '
	UPacienteBB' 0
nuevoPacienteBB1 >
)BB> ?
{CC 
tryDD 
{EE 
WraperFF 

wraperFF 
=FF 
newFF 
WraperFF 
(FF 
)FF  
;FF  !
UUsersHH 

nuevoUsuarioHH 
=HH 
newHH 
UUsersHH $
(HH$ %
)HH% &
;HH& '
nuevoUsuarioII 
.II 
	DocumentoII 
=II 
nuevoPacienteII *
.II* +
	DocumentoII+ 4
;II4 5
nuevoUsuarioJJ 
.JJ 
ClaveJJ 
=JJ 
nuevoPacienteJJ &
.JJ& '
ClaveJJ' ,
;JJ, -
nuevoUsuarioKK 
.KK 
Rol_idKK 
=KK 
$numKK 
;KK 
UsersRegisterLL 
buscarLL 
=LL 
newLL 
UsersRegisterLL ,
(LL, -
)LL- .
;LL. /
ifNN 
(NN 
(NN 	
newNN	 
DatosNN 
.NN 
UsersRegisterNN  
(NN  !
)NN! "
.NN" #0
$verificarExistenciaDocumentoPacienteNN# G
(NNG H
nuevoUsuarioNNH T
)NNT U
)NNU V
==NNW Y
nullNNZ ^
)NN^ _
{OO 
ifQQ 
(QQ 	
nuevoPacienteQQ	 
.QQ 
Documento_docenteQQ (
!=QQ) +
nullQQ, 0
&&QQ1 3
(QQ4 5
buscarQQ5 ;
.QQ; <&
AcudienteODocenteExistenteQQ< V
(QQV W
nuevoPacienteQQW d
.QQd e
Documento_docenteQQe v
,QQv w
$numQQx y
)QQy z
)QQz {
!=QQ| ~
null	QQ É
)
QQÉ Ñ
{RR 
newSS 	
DatosSS
 
.SS 
UsersRegisterSS 
(SS 
)SS 
.SS  
agregarUsuarioSS  .
(SS. /
nuevoUsuarioSS/ ;
)SS; <
;SS< =
newTT 	
DatosTT
 
.TT 
UsersRegisterTT 
(TT 
)TT 
.TT  
agregarPacienteTT  /
(TT/ 0
nuevoPacienteTT0 =
)TT= >
;TT> ?
returnUU 
wraperUU 
.UU 
MensajeUU 
=UU 
$strUU 4
;UU4 5
}VV 
elseVV 

{WW 
returnXX 
wraperXX 
.XX 
MensajeXX 
=XX 
$strXX J
;XXJ K
}YY 
}ZZ 
else[[ 
{\\ 
return]] 
wraper]] 
.]] 
Mensaje]] 
=]] 
$str]] 5
;]]5 6
}^^ 
}__ 
catch`` 
(``	 

	Exception``
 
e`` 
)`` 
{aa 
returnbb 

$strbb 
+bb 
ebb 
;bb 
}cc 
}dd 
publicff 
asyncff	 
Taskff 
<ff 
UTokenCompraff  
>ff  !
obtenerDatosCompraff" 4
(ff4 5
stringff5 ;
cedulaEff< C
)ffC D
{gg 
UTokenComprahh 
	acudientehh 
;hh 
returnjj 	
	acudientejj
 
=jj 
awaitjj 
newjj 
Datosjj  %
.jj% &
	Seguridadjj& /
(jj/ 0
)jj0 1
.jj1 2'
buscarExistenciaTokenComprajj2 M
(jjM N
cedulaEjjN U
)jjU V
;jjV W
}ll 
publicnn 
asyncnn	 
Tasknn 
<nn 

UAcudientenn 
>nn !
obtenerDatosAcudientenn  5
(nn5 6
stringnn6 <
cedulaEnn= D
)nnD E
{oo 	
UUserspp 	
usuariopp
 
=pp 
newpp 
UUserspp 
(pp 
)pp  
;pp  !

UAcudienteqq 
	acudienteqq 
=qq 
newqq 

UAcudienteqq (
(qq( )
)qq) *
;qq* +
usuariorr 

.rr
 
	Documentorr 
=rr 
cedulaErr 
;rr 
usuariott 

=tt 
newtt 
Datostt 
.tt 

UsersLogintt !
(tt! "
)tt" #
.tt# $&
verificarExistenciaUsuariott$ >
(tt> ?
usuariott? F
)ttF G
;ttG H
ifvv 
(vv 
usuariovv 
!=vv 
nullvv 
)vv  
{ww 
returnxx 

	acudientexx 
=xx 
awaitxx 
newxx  
Datosxx! &
.xx& '

UsersLoginxx' 1
(xx1 2
)xx2 3
.xx3 4/
#datosAcudienteUsuarioSegunDocumentoxx4 W
(xxW X
cedulaExxX _
)xx_ `
;xx` a
}yy 
elsezz 
{{{ 
	acudiente|| 
=|| 
null|| 
;|| 
return}} 

	acudiente}} 
;}} 
}~~ 
}
ÄÄ 
public
ÇÇ 
async
ÇÇ	 
Task
ÇÇ 
<
ÇÇ 
UDocente
ÇÇ 
>
ÇÇ !
obtenerDatosDocente
ÇÇ 1
(
ÇÇ1 2
string
ÇÇ2 8
cedulaE
ÇÇ9 @
)
ÇÇ@ A
{
ÉÉ 
UUsers
ÑÑ 	
usuario
ÑÑ
 
=
ÑÑ 
new
ÑÑ 
UUsers
ÑÑ 
(
ÑÑ 
)
ÑÑ  
;
ÑÑ  !
UDocente
ÖÖ 
	acudiente
ÖÖ 
=
ÖÖ 
new
ÖÖ 
UDocente
ÖÖ $
(
ÖÖ$ %
)
ÖÖ% &
;
ÖÖ& '
usuario
ÜÜ 

.
ÜÜ
 
	Documento
ÜÜ 
=
ÜÜ 
cedulaE
ÜÜ 
;
ÜÜ 
usuario
àà 

=
àà 
new
àà 
Datos
àà 
.
àà 

UsersLogin
àà !
(
àà! "
)
àà" #
.
àà# $(
verificarExistenciaUsuario
àà$ >
(
àà> ?
usuario
àà? F
)
ààF G
;
ààG H
if
ää 
(
ää 
usuario
ää 
!=
ää 
null
ää 
)
ää 
{
ãã 
return
åå 

	acudiente
åå 
=
åå 
await
åå 
new
åå  
Datos
åå! &
.
åå& '

UsersLogin
åå' 1
(
åå1 2
)
åå2 3
.
åå3 4/
!datosDocenteUsuarioSegunDocumento
åå4 U
(
ååU V
cedulaE
ååV ]
)
åå] ^
;
åå^ _
}
çç 
else
éé 
{
èè 
	acudiente
êê 
=
êê 
null
êê 
;
êê 
return
ëë 

	acudiente
ëë 
;
ëë 
}
íí 
}
îî 
public
ññ 
async
ññ	 
Task
ññ 
<
ññ 
	UPaciente
ññ 
>
ññ "
obtenerDatosPaciente
ññ 3
(
ññ3 4
string
ññ4 :
cedulaE
ññ; B
)
ññB C
{
óó 
UUsers
òò 	
usuario
òò
 
=
òò 
new
òò 
UUsers
òò 
(
òò 
)
òò  
;
òò  !
	UPaciente
ôô 
	acudiente
ôô 
=
ôô 
new
ôô 
	UPaciente
ôô &
(
ôô& '
)
ôô' (
;
ôô( )
usuario
öö 

.
öö
 
	Documento
öö 
=
öö 
cedulaE
öö 
;
öö 
usuario
úú 

=
úú 
new
úú 
Datos
úú 
.
úú 

UsersLogin
úú !
(
úú! "
)
úú" #
.
úú# $(
verificarExistenciaUsuario
úú$ >
(
úú> ?
usuario
úú? F
)
úúF G
;
úúG H
if
ûû 
(
ûû 
usuario
ûû 
!=
ûû 
null
ûû 
)
ûû 
{
üü 
return
†† 

	acudiente
†† 
=
†† 
await
†† 
new
††  
Datos
††! &
.
††& '

UsersLogin
††' 1
(
††1 2
)
††2 3
.
††3 4)
datosPacienteSegunDocumento
††4 O
(
††O P
cedulaE
††P W
)
††W X
;
††X Y
}
°° 
else
¢¢ 
{
££ 
	acudiente
§§ 
=
§§ 
null
§§ 
;
§§ 
return
•• 

	acudiente
•• 
;
•• 
}
¶¶ 
}
®® 
public
¨¨ 
String
¨¨	 "
putActualizarDocente
¨¨ $
(
¨¨$ %
UDocente
¨¨% -
nuevoDocente
¨¨. :
)
¨¨: ;
{
≠≠ 
try
ÆÆ 
{
ØØ 
Wraper
∞∞ 

wraper
∞∞ 
=
∞∞ 
new
∞∞ 
Wraper
∞∞ 
(
∞∞ 
)
∞∞  
;
∞∞  !
if
≤≤ 
(
≤≤ 
nuevoDocente
≤≤ 
.
≤≤ 
Nombre
≤≤ 
!=
≤≤ 
null
≤≤ #
&&
≤≤$ &
nuevoDocente
≤≤' 3
.
≤≤3 4
Apellido
≤≤4 <
!=
≤≤= ?
null
≤≤@ D
)
≤≤D E
{
≥≥ 
wraper
¥¥ 
.
¥¥ 
Mensaje
¥¥ 
=
¥¥ 
new
¥¥ 
UsersRegister
¥¥ '
(
¥¥' (
)
¥¥( )
.
¥¥) *"
putActualizarDocente
¥¥* >
(
¥¥> ?
nuevoDocente
¥¥? K
,
¥¥K L
$num
¥¥M N
)
¥¥N O
;
¥¥O P
}
µµ 
else
∑∑ 
if
∑∑	 
(
∑∑ 
nuevoDocente
∑∑ 
.
∑∑ 
Clave
∑∑ 
!=
∑∑  "
null
∑∑# '
)
∑∑' (
{
∏∏ 
wraper
ππ 
.
ππ 
Mensaje
ππ 
=
ππ 
new
ππ 
UsersRegister
ππ '
(
ππ' (
)
ππ( )
.
ππ) *"
putActualizarDocente
ππ* >
(
ππ> ?
nuevoDocente
ππ? K
,
ππK L
$num
ππM N
)
ππN O
;
ππO P
}
∫∫ 
else
ºº 
if
ºº	 
(
ºº 
nuevoDocente
ºº 
.
ºº 
Correo
ºº  
!=
ºº! #
null
ºº$ (
)
ºº( )
{
ΩΩ 
wraper
ææ 
.
ææ 
Mensaje
ææ 
=
ææ 
new
ææ 
UsersRegister
ææ '
(
ææ' (
)
ææ( )
.
ææ) *"
putActualizarDocente
ææ* >
(
ææ> ?
nuevoDocente
ææ? K
,
ææK L
$num
ææM N
)
ææN O
;
ææO P
}
øø 
else
¡¡ 
{
¬¬ 
wraper
√√ 
.
√√ 
Mensaje
√√ 
=
√√ 
$str
√√ .
;
√√. /
}
ƒƒ 
return
≈≈ 

wraper
≈≈ 
.
≈≈ 
Mensaje
≈≈ 
;
≈≈ 
}
∆∆ 
catch
«« 
(
««	 

	Exception
««
 
e
«« 
)
«« 
{
»» 
return
…… 

$str
…… 
+
…… 
e
…… 
;
…… 
}
   
}
ÀÀ 
public
ÕÕ 
String
ÕÕ	 $
putActualizarAcudiente
ÕÕ &
(
ÕÕ& '

UAcudiente
ÕÕ' 1
nuevoAcudiente
ÕÕ2 @
)
ÕÕ@ A
{
ŒŒ 
try
œœ 
{
–– 
Wraper
—— 

wraper
—— 
=
—— 
new
—— 
Wraper
—— 
(
—— 
)
——  
;
——  !
if
”” 
(
”” 
nuevoAcudiente
”” 
.
”” 
Nombre
”” 
!=
””  
null
””! %
&&
””& (
nuevoAcudiente
””) 7
.
””7 8
Apellido
””8 @
!=
””A C
null
””D H
)
””H I
{
‘‘ 
wraper
’’ 
.
’’ 
Mensaje
’’ 
=
’’ 
new
’’ 
UsersRegister
’’ '
(
’’' (
)
’’( )
.
’’) *$
putActualizarAcudiente
’’* @
(
’’@ A
nuevoAcudiente
’’A O
,
’’O P
$num
’’Q R
)
’’R S
;
’’S T
}
÷÷ 
else
ÿÿ 
if
ÿÿ	 
(
ÿÿ 
nuevoAcudiente
ÿÿ 
.
ÿÿ 
Clave
ÿÿ !
!=
ÿÿ" $
null
ÿÿ% )
)
ÿÿ) *
{
ŸŸ 
wraper
⁄⁄ 
.
⁄⁄ 
Mensaje
⁄⁄ 
=
⁄⁄ 
new
⁄⁄ 
UsersRegister
⁄⁄ '
(
⁄⁄' (
)
⁄⁄( )
.
⁄⁄) *$
putActualizarAcudiente
⁄⁄* @
(
⁄⁄@ A
nuevoAcudiente
⁄⁄A O
,
⁄⁄O P
$num
⁄⁄Q R
)
⁄⁄R S
;
⁄⁄S T
}
€€ 
else
›› 
if
››	 
(
›› 
nuevoAcudiente
›› 
.
›› 
Correo
›› "
!=
››# %
null
››& *
)
››* +
{
ﬁﬁ 
wraper
ﬂﬂ 
.
ﬂﬂ 
Mensaje
ﬂﬂ 
=
ﬂﬂ 
new
ﬂﬂ 
UsersRegister
ﬂﬂ '
(
ﬂﬂ' (
)
ﬂﬂ( )
.
ﬂﬂ) *$
putActualizarAcudiente
ﬂﬂ* @
(
ﬂﬂ@ A
nuevoAcudiente
ﬂﬂA O
,
ﬂﬂO P
$num
ﬂﬂQ R
)
ﬂﬂR S
;
ﬂﬂS T
}
‡‡ 
else
‚‚ 
{
„„ 
wraper
‰‰ 
.
‰‰ 
Mensaje
‰‰ 
=
‰‰ 
$str
‰‰ .
;
‰‰. /
}
ÂÂ 
return
ÊÊ 

wraper
ÊÊ 
.
ÊÊ 
Mensaje
ÊÊ 
;
ÊÊ 
}
ÁÁ 
catch
ËË 
(
ËË	 

	Exception
ËË
 
e
ËË 
)
ËË 
{
ÈÈ 
return
ÍÍ 

$str
ÍÍ 
+
ÍÍ 
e
ÍÍ 
;
ÍÍ 
}
ÎÎ 
}
ÏÏ 
public
 
String
	 #
putActualizarPaciente
 %
(
% &
	UPaciente
& /
nuevoPaciente
0 =
)
= >
{
ÒÒ 
try
ÚÚ 
{
ÛÛ 
Wraper
ÙÙ 

wraper
ÙÙ 
=
ÙÙ 
new
ÙÙ 
Wraper
ÙÙ 
(
ÙÙ 
)
ÙÙ  
;
ÙÙ  !
if
ˆˆ 
(
ˆˆ 
nuevoPaciente
ˆˆ 
.
ˆˆ 
Nombre
ˆˆ 
!=
ˆˆ 
null
ˆˆ  $
&&
ˆˆ% '
nuevoPaciente
ˆˆ( 5
.
ˆˆ5 6
Apellido
ˆˆ6 >
!=
ˆˆ? A
null
ˆˆB F
)
ˆˆF G
{
˜˜ 
wraper
¯¯ 
.
¯¯ 
Mensaje
¯¯ 
=
¯¯ 
new
¯¯ 
UsersRegister
¯¯ '
(
¯¯' (
)
¯¯( )
.
¯¯) *#
putActualizarPaciente
¯¯* ?
(
¯¯? @
nuevoPaciente
¯¯@ M
,
¯¯M N
$num
¯¯O P
)
¯¯P Q
;
¯¯Q R
}
˘˘ 
else
˚˚ 
if
˚˚	 
(
˚˚ 
nuevoPaciente
˚˚ 
.
˚˚ 
Clave
˚˚  
!=
˚˚! #
null
˚˚$ (
)
˚˚( )
{
¸¸ 
wraper
˝˝ 
.
˝˝ 
Mensaje
˝˝ 
=
˝˝ 
new
˝˝ 
UsersRegister
˝˝ '
(
˝˝' (
)
˝˝( )
.
˝˝) *#
putActualizarPaciente
˝˝* ?
(
˝˝? @
nuevoPaciente
˝˝@ M
,
˝˝M N
$num
˝˝O P
)
˝˝P Q
;
˝˝Q R
}
˛˛ 
else
ÄÄ 
if
ÄÄ	 
(
ÄÄ 
nuevoPaciente
ÄÄ 
.
ÄÄ 
Grado_autismo
ÄÄ (
!=
ÄÄ) +
null
ÄÄ+ /
&&
ÄÄ0 2
nuevoPaciente
ÄÄ3 @
.
ÄÄ@ A
Edad
ÄÄA E
!=
ÄÄE G
null
ÄÄG K
)
ÄÄK L
{
ÅÅ 
wraper
ÇÇ 
.
ÇÇ 
Mensaje
ÇÇ 
=
ÇÇ 
new
ÇÇ 
UsersRegister
ÇÇ '
(
ÇÇ' (
)
ÇÇ( )
.
ÇÇ) *#
putActualizarPaciente
ÇÇ* ?
(
ÇÇ? @
nuevoPaciente
ÇÇ@ M
,
ÇÇM N
$num
ÇÇO P
)
ÇÇP Q
;
ÇÇQ R
}
ÉÉ 
else
ÖÖ 
{
ÜÜ 
wraper
áá 
.
áá 
Mensaje
áá 
=
áá 
$str
áá .
;
áá. /
}
àà 
return
ââ 

wraper
ââ 
.
ââ 
Mensaje
ââ 
;
ââ 
}
ää 
catch
ãã 
(
ãã	 

	Exception
ãã
 
e
ãã 
)
ãã 
{
åå 
return
çç 

$str
çç 
+
çç 
e
çç 
;
çç 
}
éé 
}
èè 
public
ëë 
Boolean
ëë	 !
registroTokenCompra
ëë $
(
ëë$ %
UDocente
ëë% - 
datosDocenteCompra
ëë. @
)
ëë@ A
{
íí 
string
ïï 	
token
ïï
 
=
ïï 
new
ïï 
UsersRegister
ïï #
(
ïï# $
)
ïï$ %
.
ïï% &"
generaTokenAleatorio
ïï& :
(
ïï: ;
)
ïï; <
;
ïï< =
bool
óó 
mensaje
óó 
=
óó 
new
óó 
UsersRegister
óó #
(
óó# $
)
óó$ %
.
óó% & 
agregarTokenCompra
óó& 8
(
óó8 9 
datosDocenteCompra
óó9 K
,
óóK L
token
óóM R
)
óóR S
;
óóS T
if
ôô 
(
ôô 
mensaje
ôô 
==
ôô 
true
ôô 
)
ôô  
{
öö 
new
õõ 
Mail
õõ 
(
õõ 
)
õõ 
.
õõ 

enviarMail
õõ 
(
õõ  
datosDocenteCompra
õõ ,
,
õõ, -
token
õõ. 3
)
õõ3 4
;
õõ4 5
return
úú 

mensaje
úú 
;
úú 
}
ùù 
else
ûû 
if
ûû 
(
ûû 
mensaje
ûû 
==
ûû 
false
ûû $
)
ûû$ %
{
üü 
return
†† 

mensaje
†† 
;
†† 
}
°° 
else
¢¢ 
{
££ 
mensaje
§§ 
=
§§ 
false
§§ 
;
§§ 
return
•• 

mensaje
•• 
;
•• 
}
¶¶ 
}
®® 
}
™™ 
}´´ ª
èC:\Users\asant\OneDrive\Escritorio\Andres Bernal\proyectos\proyectoTEAServicios\proyectoTEAServicios\LogicaDeNegocio\Properties\AssemblyInfo.cs
[ 
assembly 	
:	 

AssemblyTitle 
( 
$str *
)* +
]+ ,
[		 
assembly		 	
:			 

AssemblyDescription		 
(		 
$str		 !
)		! "
]		" #
[

 
assembly

 	
:

	 
!
AssemblyConfiguration

  
(

  !
$str

! #
)

# $
]

$ %
[ 
assembly 	
:	 

AssemblyCompany 
( 
$str 
) 
] 
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str ,
), -
]- .
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str 0
)0 1
]1 2
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
[ 
assembly 	
:	 

Guid 
( 
$str 6
)6 7
]7 8
[## 
assembly## 	
:##	 

AssemblyVersion## 
(## 
$str## $
)##$ %
]##% &
[$$ 
assembly$$ 	
:$$	 

AssemblyFileVersion$$ 
($$ 
$str$$ (
)$$( )
]$$) *